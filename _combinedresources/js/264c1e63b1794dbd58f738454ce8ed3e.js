firefish.Web.WebControls.ffDropDownList=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffDropDownList,[n])};firefish.Web.WebControls.ffDropDownList.showLoading=function(n,t){n.prop("disabled",!0);n.find("option").remove().end().append('<option value="'+t+'">loading...<\/option>').val(t)};firefish.Web.WebControls.ffDropDownList.populateDropDownWithOptions=function(n,t,i,r,u,f,e,o){if(n){i||(i="");u||(u="");firefish.Web.WebControls.ffDropDownList.showLoading(n,r);var s="{'parentListName':'"+t+"', 'parentListSelectedItem':'"+i+"', 'parentListArgs':'"+u+"'}",h=ffControlSystem.getFunctionDelegate(this,function(t){firefish.Web.WebControls.ffDropDownList._onSuccess(t,n,r,f,e)}),c=ffControlSystem.getFunctionDelegate(this,function(t){firefish.Web.WebControls.ffDropDownList._onError(t,n,f,r,o)});ffControlSystem.callWebService("/ffControlUtilities.ashx/datalist",s,h,c)}};firefish.Web.WebControls.ffDropDownList._onSuccess=function(n,t,i,r,u){var f=null;try{f=ffParseJson(n)}catch(e){}f==null&&(f=n);firefish.Web.WebControls.ffDropDownList._convertJsonToOptions(f,t,i,r);u&&u.apply(this,[f,t])};firefish.Web.WebControls.ffDropDownList._onError=function(n,t,i,r,u){t.find("option").remove().end().append('<option value="'+i+'">Error populating dropdown<\/option>').val(i).attr("title","There was an error populating this dropdown. Please try again.");u&&u.apply(this,[n,t])};firefish.Web.WebControls.ffDropDownList._convertJsonToOptions=function(n,t,i,r){var o="",s=!1,e,u,f;for(r&&(o+='<option value="'+i+'">'+r+"<\/option>"),u=0;u<n.length;u++)o+=n[u].DisplayName?'<option value="'+n[u].ID+'">'+n[u].DisplayName+"<\/option>":'<option value="'+n[u].ID+'">'+n[u].Text+"<\/option>",s=!0;if(t.find("option").remove().end().append(o).prop("disabled",!1).val(i),s){if(t.prop("disabled",!1),t.length&&(e=t[0].Validators,e&&e.length))for(u=0;u<e.length;++u)f=e[u],f&&f.ddDisabled&&(f.ddDisabled=!1,f.enabled=!0)}else if(t.prop("disabled",!0),t.length&&(e=t[0].Validators,e&&e.length))for(u=0;u<e.length;++u)f=e[u],f&&(f.isvalid=!0,f.ddDisabled=!0,f.enabled=!1,ValidatorUpdateDisplay(f))};firefish.Web.WebControls.ffDropDownList.prototype={initialise:function(){var t,n,i,r;ffControlSystem.callBase(this,firefish.Web.WebControls.ffDropDownList,"initialise");this.childDropdown=ff$("#"+ff$.escape(this.childDropdownID));this.changeHndlr=ffControlSystem.getFunctionDelegate(this,this._onChange);this.docEle=ff$(document);this.emptyValue="-1";this.isGuid&&(this.emptyValue="00000000-0000-0000-0000-000000000000");t=this.emptyValue;this.asyncArgs||(this.asyncArgs="");n=this.Element.val();i=[];n!=t&&this.childDropdown&&this.childDropdown.length&&(this.childDropdown.find("option").map(function(n,r){var u=ff$(r).val();u!=t&&i.push({ID:ff$(r).val(),DisplayName:ff$(r).text()})}),r=n,this.parentListName&&(r=this.parentListName+"_"+n),this.docEle.data("'ddl"+r+"'",i));ffControlSystem.attachEvent(this.Element,"change",this.changeHndlr)},dispose:function(){ffControlSystem.detachEvent(this.Element,"change",this.changeHndlr)},_onChange:function(){var n,t,i,r,u;if(this.useAsync)if(n=this.Element.val(),n==this.emptyValue)this.childDropdown.find("option").remove().end().append('<option value="'+this.emptyValue+'">'+this.childBlankItemText+"<\/option>").val(this.emptyValue);else{if(t=n,this.parentListName&&(t=this.parentListName+"_"+n),this.docEle.data("'ddl"+t+"'")){i=null;this.childHasBlankItem&&(i=this.childBlankItemText);firefish.Web.WebControls.ffDropDownList._convertJsonToOptions(this.docEle.data("'ddl"+t+"'"),this.childDropdown,this.emptyValue,i);return}r=ffControlSystem.getFunctionDelegate(this,this.onSuccess);u=ffControlSystem.getFunctionDelegate(this,this.onError);firefish.Web.WebControls.ffDropDownList.populateDropDownWithOptions(this.childDropdown,this.parentListName,n,this.emptyValue,this.asyncArgs,this.childBlankItemText,r,u)}else firefish.Web.WebControls.ffDropDownList.showLoading(this.childDropdown,this.dropDown)},onSuccess:function(n){var t=this.Element.val();this.parentListName&&(t=this.parentListName+"_"+t);this.docEle.data("'ddl"+t+"'",n)},onError:function(){}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffDropDownList,firefish.Web.WebControls.WebControl);
firefish.Web.WebControls.ffGridView=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffGridView,[n])};firefish.Web.WebControls.ffGridView.prototype={initialise:function(){if(ffControlSystem.callBase(this,firefish.Web.WebControls.ffGridView,"initialise"),this.mouseenterHndlr=ffControlSystem.getFunctionDelegate(this,this._onHighlightRow),this.mouseleaveHndlr=ffControlSystem.getFunctionDelegate(this,this._onClearhighlightedRow),this.clickHndlr=ffControlSystem.getFunctionDelegate(this,this._onClick),this.chkclickHndlr=ffControlSystem.getFunctionDelegate(this,this._onChkClick),this.chkHeaderclickHndlr=ffControlSystem.getFunctionDelegate(this,this._onChkHeaderClick),this.defaultErrorHndlr=ffControlSystem.getFunctionDelegate(this,this._onCallbackError),this.defaultSuccessHndlr=ffControlSystem.getFunctionDelegate(this,this._onCallbackSuccess),this.headerRowDisplayed=this.Element.find("TH").length>0,this.tableRows=this.Element.find("TR.resultsRow"),this.chkBoxes=this.Element.find("input:checkbox:enabled"),this.chkBoxHeader=this.chkBoxes.filter(function(){return ff$(this).attr("id").match(/chkbx_\d*Header/)}),this.rowHighlightingEnabled)this.tableRows.on("mouseenter",this.mouseenterHndlr).on("mouseleave",this.mouseleaveHndlr);if(this.rowClickEnabled)this.tableRows.on("click",this.clickHndlr);this.chkBoxHeader.on("change",this.chkHeaderclickHndlr);this.chkBoxes.on("change",this.chkclickHndlr)},postInitialise:function(){this.hfWarningLabelIDs&&this.checkChkBoxes()},dispose:function(){var n=this.Element.find("TR.resultsRow");this.rowHighlightingEnabled&&n.unbind("mouseenter",this.mouseenterHndlr).unbind("mouseleave",this.mouseleaveHndlr);this.rowClickEnabled&&n.unbind("click",this.clickHndlr);this.chkBoxes&&this.chkclickHndlr&&this.chkBoxes.unbind("click",this.chkclickHndlr);this.chkBoxHeader&&this.chkHeaderclickHndlr&&this.chkBoxHeader.unbind("click",this.chkHeaderclickHndlr)},_webServiceCall:function(n,t){var i="/_firefish/Handlers/gridviewHandler.ashx";t&&(i="/_firefish/Handlers/"+t,t.indexOf&&t.indexOf(".ashx")==-1&&(i+=".ashx"));ffControlSystem.callWebService(i,n,this.defaultSuccessHndlr,this.defaultErrorHndlr)},_onHighlightRow:function(n){this.rowHighlightingEnabled&&(this._onClearhighlightedRow(n),ff$(n.currentTarget).addClass(this.highlightCssClass))},_onCallbackSuccess:function(n){if(n&&(n=ffParseJson(n)),this.onCallbackSuccess)this.onCallbackSuccess(n)},_onCallbackError:function(n){if(n&&(n=ffParseJson(n)),n&&n.error&&this.onCallbackError)this.onCallbackError(n)},_onClearhighlightedRow:function(){this.rowHighlightingEnabled&&this.tableRows.filter("TR."+this.highlightCssClass).removeClass(this.highlightCssClass)},_onChkClick:function(){this.checkChkBoxes()},_onChkHeaderClick:function(){this.chkBoxHeader&&this.chkBoxes&&this.chkBoxes.prop("checked",this.chkBoxHeader.prop("checked"));this.checkChkBoxes()},_onClick:function(n){var f,r;if(this.rowClickEnabled){var i=n.target,t=n.target.tagName.toUpperCase(),u=ff$(n.target).closest("#"+this.Element.attr("id")+" > TBODY > TR"),e=ff$(i);if(e.data("gridviewRowClick")=="prevent")return;t=="SPAN"&&(i=n.target.parentNode,t=i.tagName.toUpperCase());f=this.getSelectedIDs();this.selectedItemsHandler!=null&&eval(this.selectedItemsHandler+"('"+f+"')");t!="INPUT"&&t!="A"&&t!="TEXTAREA"&&t!="SELECT"&&(r=u.data("rowurl"),r?window.location.href=r:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(this.ffControlID.replace(/_/g,"$"),u.data("rowid"),!1,"","",!1,!0)))}},getSelectedIDs:function(){var t="",i=this.Element.find("input:checkbox:checked:enabled").closest("tr"),n=[];return i.each(function(){ff$(this).data("rowid")!=undefined&&n.push(ff$(this).data("rowid").replace("Row",""))}),n.length>0&&(t=n.join(",")),t},checkChkBoxes:function(){var t,n,r,i;if(this.hfWarningLabelIDs){t=this.Element.find("input:checkbox:checked:enabled");n=0;t&&(n=t.length);t=this.Element.find("TH input:checkbox:checked:enabled");t&&(n-=t.length);r=this.hfWarningLabelIDs.split(",");for(entry in r)i=ff$("#"+r[entry]),n>0?(i.show(),i.html(" ("+n.toString()+" record"+(n>1?"s ":" ")+"selected)")):i.hide();this.Element.trigger("chkedBoxesCountChanged",n)}}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffGridView,firefish.Web.WebControls.WebControl);firefish.Web.WebControls.ffGridView.SetCheckedValueForAllRowsFromHeader=function(n){var i=ff$(n).prop("checked"),t=ff$(n).closest("table").next().find('td:first-child input[type="checkbox"]:enabled');t.prop("checked",i);t.triggerHandler("click")};
firefish.Web.WebControls.ffTextBox=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffTextBox,[n])};firefish.Web.WebControls.ffTextBox.prototype={initialise:function(){var i,r,u,n,t;ffControlSystem.callBase(this,firefish.Web.WebControls.ffTextBox,"initialise");this.txtTextBox=this.Element;this.txtTextBox&&(this.txtTextBox.prop("placeholder")&&(i=new Date,ffControlSystem.attachEvent(this.txtTextBox,"focus",function(){var n=new Date,t;n.getTime()-i.getTime()>500&&(i=n,t=this,setTimeout(function(){t.focus()},10))})),r=ffControlSystem.getFunctionDelegate(this,this.onKeyUp),ffControlSystem.attachEvent(this.txtTextBox,"keyup",r),u=ffControlSystem.getFunctionDelegate(this,this.onKeyPress),ffControlSystem.attachEvent(this.txtTextBox,"keypress",u));n=null;n=this.isRequired?ff$(this.txtTextBox).siblings(".characterCountRequired"):ff$(this.txtTextBox).siblings(".characterCount");n&&(n.length==0&&this.txtTextBox?(t=this.txtTextBox.parent(),t&&t.length&&this.showCharacterCount&&(this.lblMaxLength=document.createElement("div"),this.lblMaxLength.className=this.isRequired?"characterCountRequired":"characterCount",t.append(this.lblMaxLength))):this.showCharacterCount||n.hide());this.displayRemainingCharacters();this.enforceInputCapitalisation()},onKeyPress:function(){this.displayRemainingCharacters();this.enforceInputCapitalisation()},onKeyUp:function(){this.displayRemainingCharacters();this.enforceInputCapitalisation()},getChildElement:function(n){var i=null,t=this.get_element(),r;return t&&(r=t.id+"_"+n,i=$get(r,t)),i},displayRemainingCharacters:function(){if(this.lblMaxLength&&this.showCharacterCount&&this.txtTextBox){var n=this.maxLength-this.txtTextBox.val().length;n<0&&(n=0);this.lblMaxLength.innerHTML=n==0?"No characters remaining.":n==1?n+" character remaining.":n+" characters remaining."}},enforceInputCapitalisation:function(){if(this.enforceCapitalisation&&this.txtTextBox){var n=this.txtTextBox.val();n=n.toUpperCase();this.txtTextBox.val(n)}}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffTextBox,firefish.Web.WebControls.WebControl);
firefish.Web.WebControls.ffHyperLink=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffHyperLink,[n])};firefish.Web.WebControls.ffHyperLink.prototype={initialise:function(){ffControlSystem.callBase(this,firefish.Web.WebControls.ffHyperLink,"initialise");this.copyIcon=this.Element.siblings(".ff-copyURL__icon");this.copyURLEvnt=ffControlSystem.getFunctionDelegate(this.copyIcon,this._copyURLToClipboard);ffControlSystem.attachEvent(this.copyIcon,"click",this.copyURLEvnt)},dispose:function(){ffControlSystem.detachEvent(this.copyIcon,"click",this.copyURLEvnt)},_copyURLToClipboard:function(){var n=this,t=ff$("<input>");ff$("body").append(t);t.val(n.siblings("a")[0].href).select();document.execCommand("copy");t.remove();n.siblings(".ff-copyURL__notification").toggleClass("ff-copyURL__notification--active");setTimeout(function(){n.siblings(".ff-copyURL__notification").toggleClass("ff-copyURL__notification--active")},1e3)}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffHyperLink,firefish.Web.WebControls.WebControl);
firefish.Web.WebControls.ffModalPanel=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffModalPanel,[n])};firefish.Web.WebControls.ffModalPanel.prototype={initialise:function(){ffControlSystem.callBase(this,firefish.Web.WebControls.ffModalPanel,"initialise");this.scrolled=!1;this.baseElement=this.Element;this.background=ff$("#"+this.baseElement.attr("id")+"MdlBckgrnd");this.background.length==0&&(this.windowResizeHandler=ffControlSystem.getFunctionDelegate(this,this.onResize),ffControlSystem.attachEvent(ff$(window),"resize",this.windowResizeHandler),this.windowScrollHandler=ffControlSystem.getFunctionDelegate(this,this.onScroll),ffControlSystem.attachEvent(ff$(window),"scroll",this.windowScrollHandler),this.panelBodyScrollFunction&&(this.panelBodyScrollHdlr=this.getPanelScrollHdlr(),ffControlSystem.attachEvent(ff$(".modalPanel .mdl-body"),"scroll",this.panelBodyScrollHdlr)));this.mdlHideHdlr=ffControlSystem.getFunctionDelegate(this,function(){this.showModalPanel(!1)});this.escHdlr=ffControlSystem.getFunctionDelegate(this,this._escClose);this.allowEscClose&&(ff$.browser.msie&&parseInt(ff$.browser.version)<9&&ffControlSystem.attachEvent(ff$(document.body),"keyup",this.escHdlr),ffControlSystem.attachEvent(ff$(window),"keyup",this.escHdlr));this.domChangedHandler=ffControlSystem.getFunctionDelegate(this,this.doLayout);ffControlSystem.events.domChanged.subscribe(this.domChangedHandler);this.Element.children.length?(this.CloseBtn=this.Element.children().first().find("span.mdl-hdr-btn"),""!=this.titleText&&this.Element.children().first().find("span.mdl-hdr-txt").text(this.titleText)):this.CloseBtn=this.Element.find("span.mdl-hdr-btn");this.CloseBtn.length>0&&ffControlSystem.attachEvent(this.CloseBtn,"click",this.mdlHideHdlr);this.initialiseControls();this.hfShowPanel=this.getChildElement("hfShowPanel");this.hfArgs=this.getChildElement("hfArgs");this.doLayout()},dispose:function(){this.background.remove();ffControlSystem.detachEvent(ff$(window),"scroll",this.windowScrollHandler);ffControlSystem.detachEvent(ff$(window),"resize",this.windowResizeHandler);this.domChangedHandler&&ffControlSystem.events.domChanged.unsubscribe(this.domChangedHandler);this.background=this.windowResizeHandler=this.windowScrollHandler=null;ff$(document.body).css({"margin-right":0,overflow:"visible"})},initialiseControls:function(){var n;this.background.length==0&&(this.background=ff$("<div class='modalBackground' id='"+this.baseElement.attr("id")+"MdlBckgrnd' />").hide().insertAfter(this.Element.parent()));this.modalLevel>1&&(this.background.css("zIndex",parseInt(this.background.css("zIndex")*this.modalLevel)),n=this.baseElement.parent(),n.css("zIndex",parseInt(n.css("zIndex")*this.modalLevel)));this.customZIndex&&this.customZIndex>0&&(this.background.css("zIndex",this.customZIndex-1),n=this.baseElement.parent(),n.css("zIndex",this.customZIndex));this.baseElement.parent().hide()},_escClose:function(n){this.showPanel&&n.which==27&&this.showModalPanel(!1)},onResize:function(){this.doLayout()},onScroll:function(){this.scrolled||(this.scrolled=!0,this.doLayout(),setTimeout(function(){this.scrolled=!1},500))},getPanelScrollHdlr:function(){if(this.panelBodyScrollFunction)return eval("ffControlSystem.getFunctionDelegate(this, "+this.panelBodyScrollFunction+");")},recalculateSize:function(){this.baseElement.parent().height(this.baseElement.parent().find("> *").outerHeight());this.doLayout()},_setBasePosition:function(n,t,i,r){var o,c,f,a,e;if(r<4)if(o=n.outerWidth(),o==0)c=this,window.setTimeout(function(){c._setBasePosition(n,t,i,++r)},200);else{var u=n.find(".mdl-body:first"),v=n.find(".mdl-hdr:first").outerHeight(),l=Math.max(this.Element.height());this.UseOversizeAutoScrolling&&(f=t-v-40,u.css("max-height",f),t<l||this.isPinned&&.84*t<l?(this.isPinned&&(f-=.16*t),f<60&&(f=60),u.get(0).scrollHeight<=t?u.height("").css("overflow","auto").css("overflowX",""):u.height(f).css("overflow","auto").css("overflowX","hidden")):(u.height("").css({overflow:"auto","overflow-x":"hidden"}),a=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),a&&u.css("padding-right","25px")),i<o&&!this.isPinned?(n.css("right","0px"),u.css("overflowX","auto")):n.css("right",""));ff$.browser.msie&&parseInt(ff$.browser.version)<=7&&(e=n.find("div.mdl-hdr"),e.length>0&&!e.data("widthset")&&e.width(e.parent().width()-6).data("widthset",!0));var y=n.outerHeight(),o=n.outerWidth(),s=(i-o)/2,h=(t-y)/2;h<0&&(h=0);s<0&&(s=0);n.css("left",s);n.css("top",h)}},_getChildrenHeight:function(n){var t=0;return ff$(n).children().each(function(){t+=ff$(this).outerHeight()}),t},doLayout:function(){if(this.showPanel){var t=ff$(window).height(),n=ff$(window).width();this.baseElement.parent().css("top","-1000px");this.baseElement.parent().css("left","-1000px");this.baseElement.parent().css("right","");this.baseElement.parent().show();this._setBasePosition(this.baseElement.parent(),t,n,0);this.hfShowPanel&&this.hfShowPanel.val(!0);window.innerWidth-n&&ff$(document.body).css({"margin-right":window.innerWidth-n});ff$(document.body).css({"margin-right":0,overflow:"hidden"});this.background.show()}else this.baseElement.parent().hide(),this.background||(this.background=ff$("#"+this.baseElement.attr("id")+"MdlBckgrnd")),this.background.hide()},showModalPanel:function(n){this.showPanel=n;this.hfShowPanel&&this.hfShowPanel.val(n);ff$(document.body).css({"margin-right":0,overflow:"visible"});this.doLayout();n||this.Element.trigger("modalClosed");!n&&this.postbackOnClose&&__doPostBack()},setArgs:function(n){this.hfArgs&&this.hfArgs.val(n)}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffModalPanel,firefish.Web.WebControls.WebControl);firefish.Web.WebControls.ffModalPanel.show=function(n,t){var i=ffControlSystem.getControl(n);i&&(i.showModalPanel(!0),t&&i.setArgs(t))};firefish.Web.WebControls.ffModalPanel.hide=function(n){var t=ffControlSystem.getControl(n);t&&t.showModalPanel(!1)};
jQuery.noConflict(!0);
