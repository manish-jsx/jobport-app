firefish.Web.WebControls.ffDropDownList=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffDropDownList,[n])};firefish.Web.WebControls.ffDropDownList.showLoading=function(n,t){n.prop("disabled",!0);n.find("option").remove().end().append('<option value="'+t+'">loading...<\/option>').val(t)};firefish.Web.WebControls.ffDropDownList.populateDropDownWithOptions=function(n,t,i,r,u,f,e,o){if(n){i||(i="");u||(u="");firefish.Web.WebControls.ffDropDownList.showLoading(n,r);var s="{'parentListName':'"+t+"', 'parentListSelectedItem':'"+i+"', 'parentListArgs':'"+u+"'}",h=ffControlSystem.getFunctionDelegate(this,function(t){firefish.Web.WebControls.ffDropDownList._onSuccess(t,n,r,f,e)}),c=ffControlSystem.getFunctionDelegate(this,function(t){firefish.Web.WebControls.ffDropDownList._onError(t,n,f,r,o)});ffControlSystem.callWebService("/ffControlUtilities.ashx/datalist",s,h,c)}};firefish.Web.WebControls.ffDropDownList._onSuccess=function(n,t,i,r,u){var f=null;try{f=ffParseJson(n)}catch(e){}f==null&&(f=n);firefish.Web.WebControls.ffDropDownList._convertJsonToOptions(f,t,i,r);u&&u.apply(this,[f,t])};firefish.Web.WebControls.ffDropDownList._onError=function(n,t,i,r,u){t.find("option").remove().end().append('<option value="'+i+'">Error populating dropdown<\/option>').val(i).attr("title","There was an error populating this dropdown. Please try again.");u&&u.apply(this,[n,t])};firefish.Web.WebControls.ffDropDownList._convertJsonToOptions=function(n,t,i,r){var o="",s=!1,e,u,f;for(r&&(o+='<option value="'+i+'">'+r+"<\/option>"),u=0;u<n.length;u++)o+=n[u].DisplayName?'<option value="'+n[u].ID+'">'+n[u].DisplayName+"<\/option>":'<option value="'+n[u].ID+'">'+n[u].Text+"<\/option>",s=!0;if(t.find("option").remove().end().append(o).prop("disabled",!1).val(i),s){if(t.prop("disabled",!1),t.length&&(e=t[0].Validators,e&&e.length))for(u=0;u<e.length;++u)f=e[u],f&&f.ddDisabled&&(f.ddDisabled=!1,f.enabled=!0)}else if(t.prop("disabled",!0),t.length&&(e=t[0].Validators,e&&e.length))for(u=0;u<e.length;++u)f=e[u],f&&(f.isvalid=!0,f.ddDisabled=!0,f.enabled=!1,ValidatorUpdateDisplay(f))};firefish.Web.WebControls.ffDropDownList.prototype={initialise:function(){var t,n,i,r;ffControlSystem.callBase(this,firefish.Web.WebControls.ffDropDownList,"initialise");this.childDropdown=ff$("#"+ff$.escape(this.childDropdownID));this.changeHndlr=ffControlSystem.getFunctionDelegate(this,this._onChange);this.docEle=ff$(document);this.emptyValue="-1";this.isGuid&&(this.emptyValue="00000000-0000-0000-0000-000000000000");t=this.emptyValue;this.asyncArgs||(this.asyncArgs="");n=this.Element.val();i=[];n!=t&&this.childDropdown&&this.childDropdown.length&&(this.childDropdown.find("option").map(function(n,r){var u=ff$(r).val();u!=t&&i.push({ID:ff$(r).val(),DisplayName:ff$(r).text()})}),r=n,this.parentListName&&(r=this.parentListName+"_"+n),this.docEle.data("'ddl"+r+"'",i));ffControlSystem.attachEvent(this.Element,"change",this.changeHndlr)},dispose:function(){ffControlSystem.detachEvent(this.Element,"change",this.changeHndlr)},_onChange:function(){var n,t,i,r,u;if(this.useAsync)if(n=this.Element.val(),n==this.emptyValue)this.childDropdown.find("option").remove().end().append('<option value="'+this.emptyValue+'">'+this.childBlankItemText+"<\/option>").val(this.emptyValue);else{if(t=n,this.parentListName&&(t=this.parentListName+"_"+n),this.docEle.data("'ddl"+t+"'")){i=null;this.childHasBlankItem&&(i=this.childBlankItemText);firefish.Web.WebControls.ffDropDownList._convertJsonToOptions(this.docEle.data("'ddl"+t+"'"),this.childDropdown,this.emptyValue,i);return}r=ffControlSystem.getFunctionDelegate(this,this.onSuccess);u=ffControlSystem.getFunctionDelegate(this,this.onError);firefish.Web.WebControls.ffDropDownList.populateDropDownWithOptions(this.childDropdown,this.parentListName,n,this.emptyValue,this.asyncArgs,this.childBlankItemText,r,u)}else firefish.Web.WebControls.ffDropDownList.showLoading(this.childDropdown,this.dropDown)},onSuccess:function(n){var t=this.Element.val();this.parentListName&&(t=this.parentListName+"_"+t);this.docEle.data("'ddl"+t+"'",n)},onError:function(){}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffDropDownList,firefish.Web.WebControls.WebControl);
firefish.Web.WebControls.ffTextBox=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffTextBox,[n])};firefish.Web.WebControls.ffTextBox.prototype={initialise:function(){var i,r,u,n,t;ffControlSystem.callBase(this,firefish.Web.WebControls.ffTextBox,"initialise");this.txtTextBox=this.Element;this.txtTextBox&&(this.txtTextBox.prop("placeholder")&&(i=new Date,ffControlSystem.attachEvent(this.txtTextBox,"focus",function(){var n=new Date,t;n.getTime()-i.getTime()>500&&(i=n,t=this,setTimeout(function(){t.focus()},10))})),r=ffControlSystem.getFunctionDelegate(this,this.onKeyUp),ffControlSystem.attachEvent(this.txtTextBox,"keyup",r),u=ffControlSystem.getFunctionDelegate(this,this.onKeyPress),ffControlSystem.attachEvent(this.txtTextBox,"keypress",u));n=null;n=this.isRequired?ff$(this.txtTextBox).siblings(".characterCountRequired"):ff$(this.txtTextBox).siblings(".characterCount");n&&(n.length==0&&this.txtTextBox?(t=this.txtTextBox.parent(),t&&t.length&&this.showCharacterCount&&(this.lblMaxLength=document.createElement("div"),this.lblMaxLength.className=this.isRequired?"characterCountRequired":"characterCount",t.append(this.lblMaxLength))):this.showCharacterCount||n.hide());this.displayRemainingCharacters();this.enforceInputCapitalisation()},onKeyPress:function(){this.displayRemainingCharacters();this.enforceInputCapitalisation()},onKeyUp:function(){this.displayRemainingCharacters();this.enforceInputCapitalisation()},getChildElement:function(n){var i=null,t=this.get_element(),r;return t&&(r=t.id+"_"+n,i=$get(r,t)),i},displayRemainingCharacters:function(){if(this.lblMaxLength&&this.showCharacterCount&&this.txtTextBox){var n=this.maxLength-this.txtTextBox.val().length;n<0&&(n=0);this.lblMaxLength.innerHTML=n==0?"No characters remaining.":n==1?n+" character remaining.":n+" characters remaining."}},enforceInputCapitalisation:function(){if(this.enforceCapitalisation&&this.txtTextBox){var n=this.txtTextBox.val();n=n.toUpperCase();this.txtTextBox.val(n)}}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffTextBox,firefish.Web.WebControls.WebControl);
firefish.Web.WebControls.ffDecimalFigure=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffDecimalFigure,[n]);this.showCurrency=!1;this.precision=2;this.currencySymbol="";this.decimalSeparator=".";this.thousandSeparator=","};firefish.Web.WebControls.ffDecimalFigure.prototype={initialise:function(){var n,t;ffControlSystem.callBase(this,firefish.Web.WebControls.ffDecimalFigure,"initialise");n=ffControlSystem.getFunctionDelegate(this,this.onFocus);ffControlSystem.attachEvent(this.Element,"focus",n);t=ffControlSystem.getFunctionDelegate(this,this.onBlur);ffControlSystem.attachEvent(this.Element,"blur",t);this.txtTextBox=this.domElement;this.setTextBoxValue(this.showCurrency,!1)},onFocus:function(){this.setTextBoxValue(this.showCurrency,!0)},onBlur:function(){this.setTextBoxValue(this.showCurrency,!1)},setTextBoxValue:function(n,t){var f=this.txtTextBox.value,e=this.txtTextBox.defaultValue,r=!0,u=0,i;f&&(r=this.formatNumber(!t));n&&r&&(i=this.currencySymbol+" ",this.txtTextBox.value=i+this.txtTextBox.value,u=i.length);t&&this.selectText(u,this.txtTextBox.value.length)},selectText:function(n,t){if(this.txtTextBox)if(this.txtTextBox.createTextRange){var i=this.txtTextBox.createTextRange();i.moveStart("character",n);i.moveEnd("character",t);i.select()}else this.txtTextBox.selectionStart?(this.txtTextBox.focus(),this.txtTextBox.setSelectionRange(n,t)):this.txtTextBox.focus()},formatNumber:function(n){var u,t,h,f,i,l,e,a,o,r,c,s,v;if(!this.txtTextBox)return!1;u=!1;t=this.txtTextBox.value;const y=firefish.Web.WebControls.ffDecimalFigure.EnsureRegExpFormattedSeparator(this.thousandSeparator);t=t.replace(new RegExp(y,"g"),"");const p=firefish.Web.WebControls.ffDecimalFigure.EnsureRegExpFormattedSeparator(this.decimalSeparator);if(t=t.replace(new RegExp(p,"g"),"."),h=!1,f=0,t.length>f&&t[f]=="-"&&(h=!0,f++),t=t.substring(f),t=t.replace(this.currencySymbol+" ",""),t=t.replace(this.currencySymbol,""),t=t.replace("k","000"),t=t.replace("K","000"),t=t.trim(),h&&(t="-"+t),i=parseFloat(t),l=new RegExp("^([-]|[+]|[.]|["+this.thousandSeparator+"]|[0-9])*$"),isNaN(i)||!t.match(l))this.txtTextBox.value=t,t==""&&(u=!0);else if(i==0)this.txtTextBox.value="0",u=!0;else{for(this.valueUnits>1&&i<this.valueUnits&&(i=i*this.valueUnits,t=i+""),e=t.split("."),isNaN(i)||(a=i.toFixed(this.precision)+"",e=a.split(".")),o=e[0],r="",e.length>1&&(r=e[1],r=this.showCurrency?r.replace(/^0+$/,""):r.replace(/0+$/,""),r.length&&(r=this.decimalSeparator+r)),c=/(\d+)(\d{3})/;c.test(o);)o=o.replace(c,"$1"+this.thousandSeparator+"$2");this.txtTextBox.value=o+r;u=!0}if(n&&this.Element[0]!=undefined&&this.Element[0].Validators)for(s=0;s<this.Element[0].Validators.length;s++)v=this.Element[0].Validators[s],ValidatorValidate(v);return u},getValueAsFloat:function(){var n="0",i,t;this.setTextBoxValue(this.showCurrency,!1);const r=firefish.Web.WebControls.ffDecimalFigure.EnsureRegExpFormattedSeparator(this.thousandSeparator),u=this.decimalSeparator;return this.txtTextBox&&(i=new RegExp(r,"g"),n=this.txtTextBox.value.replace(i,""),n=n.replace(u,"."),n=n.replace(this.currencySymbol+" ",""),n=n.replace(this.currencySymbol,""),n=n.replace(/ /g,"")),t=parseFloat(n).toFixed(this.precision),isNaN(t)&&(t=0),t},setValue:function(n,t){if(this.txtTextBox){if(t){let t="";n&&(t=n.toString(),t=t.replace(".",this.decimalSeparator));this.txtTextBox.value=t}else this.txtTextBox.value=n;this.setTextBoxValue(this.showCurrency,!1)}},getValueText:function(){var n="";return this.txtTextBox&&(n=this.txtTextBox.value),n},getCurrencySymbol:function(){return this.currencySymbol},getThousandSeparator:function(){return this.thousandSeparator},getDecimalSeparator:function(){return this.decimalSeparator}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffDecimalFigure,firefish.Web.WebControls.WebControl);firefish.Web.WebControls.ffDecimalFigure.ValidateRequiredField=function(n,t){var f,r,i,u,o,s,e;(t.IsValid=!0,n&&n.id)&&(f=n.id.replace("_cvRequired",""),f)&&(r=ffControlSystem.getControl(f),r&&r.getValueText)&&(i=r.getValueText(),u=r.getThousandSeparator(),u=firefish.Web.WebControls.ffDecimalFigure.EnsureRegExpFormattedSeparator(u),o=new RegExp(u,"g"),i=i.replace(o,""),s=r.getDecimalSeparator(),i=i.replace(s,"."),e=r.getCurrencySymbol(),i=i.replace(e+" ",""),i=i.replace(e,""),i=i.replace(/ /g,""),i==""&&(t.IsValid=!1),r.isZeroEmptyText&&parseFloat(i)===0&&(t.IsValid=!1))};firefish.Web.WebControls.ffDecimalFigure.GetValueAsFloat=function(n,t){var i=t;return n&&(n.length&&(n=ffControlSystem.getControl(n.attr("id"))),n&&n.getValueAsFloat&&(i=parseFloat(n.getValueAsFloat()))),i};firefish.Web.WebControls.ffDecimalFigure.TrySetValue=function(n,t){if(n&&!Number.isNaN(t)&&(n.length&&(n=ffControlSystem.getControl(n.attr("id"))),n&&n.setValue))n.setValue(t,!0)};firefish.Web.WebControls.ffDecimalFigure.EnsureRegExpFormattedSeparator=function(n){var t=n;return t==="."&&(t="\\."),t};
firefish.Web.WebControls.ffModalPanel=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffModalPanel,[n])};firefish.Web.WebControls.ffModalPanel.prototype={initialise:function(){ffControlSystem.callBase(this,firefish.Web.WebControls.ffModalPanel,"initialise");this.scrolled=!1;this.baseElement=this.Element;this.background=ff$("#"+this.baseElement.attr("id")+"MdlBckgrnd");this.background.length==0&&(this.windowResizeHandler=ffControlSystem.getFunctionDelegate(this,this.onResize),ffControlSystem.attachEvent(ff$(window),"resize",this.windowResizeHandler),this.windowScrollHandler=ffControlSystem.getFunctionDelegate(this,this.onScroll),ffControlSystem.attachEvent(ff$(window),"scroll",this.windowScrollHandler),this.panelBodyScrollFunction&&(this.panelBodyScrollHdlr=this.getPanelScrollHdlr(),ffControlSystem.attachEvent(ff$(".modalPanel .mdl-body"),"scroll",this.panelBodyScrollHdlr)));this.mdlHideHdlr=ffControlSystem.getFunctionDelegate(this,function(){this.showModalPanel(!1)});this.escHdlr=ffControlSystem.getFunctionDelegate(this,this._escClose);this.allowEscClose&&(ff$.browser.msie&&parseInt(ff$.browser.version)<9&&ffControlSystem.attachEvent(ff$(document.body),"keyup",this.escHdlr),ffControlSystem.attachEvent(ff$(window),"keyup",this.escHdlr));this.domChangedHandler=ffControlSystem.getFunctionDelegate(this,this.doLayout);ffControlSystem.events.domChanged.subscribe(this.domChangedHandler);this.Element.children.length?(this.CloseBtn=this.Element.children().first().find("span.mdl-hdr-btn"),""!=this.titleText&&this.Element.children().first().find("span.mdl-hdr-txt").text(this.titleText)):this.CloseBtn=this.Element.find("span.mdl-hdr-btn");this.CloseBtn.length>0&&ffControlSystem.attachEvent(this.CloseBtn,"click",this.mdlHideHdlr);this.initialiseControls();this.hfShowPanel=this.getChildElement("hfShowPanel");this.hfArgs=this.getChildElement("hfArgs");this.doLayout()},dispose:function(){this.background.remove();ffControlSystem.detachEvent(ff$(window),"scroll",this.windowScrollHandler);ffControlSystem.detachEvent(ff$(window),"resize",this.windowResizeHandler);this.domChangedHandler&&ffControlSystem.events.domChanged.unsubscribe(this.domChangedHandler);this.background=this.windowResizeHandler=this.windowScrollHandler=null;ff$(document.body).css({"margin-right":0,overflow:"visible"})},initialiseControls:function(){var n;this.background.length==0&&(this.background=ff$("<div class='modalBackground' id='"+this.baseElement.attr("id")+"MdlBckgrnd' />").hide().insertAfter(this.Element.parent()));this.modalLevel>1&&(this.background.css("zIndex",parseInt(this.background.css("zIndex")*this.modalLevel)),n=this.baseElement.parent(),n.css("zIndex",parseInt(n.css("zIndex")*this.modalLevel)));this.customZIndex&&this.customZIndex>0&&(this.background.css("zIndex",this.customZIndex-1),n=this.baseElement.parent(),n.css("zIndex",this.customZIndex));this.baseElement.parent().hide()},_escClose:function(n){this.showPanel&&n.which==27&&this.showModalPanel(!1)},onResize:function(){this.doLayout()},onScroll:function(){this.scrolled||(this.scrolled=!0,this.doLayout(),setTimeout(function(){this.scrolled=!1},500))},getPanelScrollHdlr:function(){if(this.panelBodyScrollFunction)return eval("ffControlSystem.getFunctionDelegate(this, "+this.panelBodyScrollFunction+");")},recalculateSize:function(){this.baseElement.parent().height(this.baseElement.parent().find("> *").outerHeight());this.doLayout()},_setBasePosition:function(n,t,i,r){var o,c,f,a,e;if(r<4)if(o=n.outerWidth(),o==0)c=this,window.setTimeout(function(){c._setBasePosition(n,t,i,++r)},200);else{var u=n.find(".mdl-body:first"),v=n.find(".mdl-hdr:first").outerHeight(),l=Math.max(this.Element.height());this.UseOversizeAutoScrolling&&(f=t-v-40,u.css("max-height",f),t<l||this.isPinned&&.84*t<l?(this.isPinned&&(f-=.16*t),f<60&&(f=60),u.get(0).scrollHeight<=t?u.height("").css("overflow","auto").css("overflowX",""):u.height(f).css("overflow","auto").css("overflowX","hidden")):(u.height("").css({overflow:"auto","overflow-x":"hidden"}),a=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),a&&u.css("padding-right","25px")),i<o&&!this.isPinned?(n.css("right","0px"),u.css("overflowX","auto")):n.css("right",""));ff$.browser.msie&&parseInt(ff$.browser.version)<=7&&(e=n.find("div.mdl-hdr"),e.length>0&&!e.data("widthset")&&e.width(e.parent().width()-6).data("widthset",!0));var y=n.outerHeight(),o=n.outerWidth(),s=(i-o)/2,h=(t-y)/2;h<0&&(h=0);s<0&&(s=0);n.css("left",s);n.css("top",h)}},_getChildrenHeight:function(n){var t=0;return ff$(n).children().each(function(){t+=ff$(this).outerHeight()}),t},doLayout:function(){if(this.showPanel){var t=ff$(window).height(),n=ff$(window).width();this.baseElement.parent().css("top","-1000px");this.baseElement.parent().css("left","-1000px");this.baseElement.parent().css("right","");this.baseElement.parent().show();this._setBasePosition(this.baseElement.parent(),t,n,0);this.hfShowPanel&&this.hfShowPanel.val(!0);window.innerWidth-n&&ff$(document.body).css({"margin-right":window.innerWidth-n});ff$(document.body).css({"margin-right":0,overflow:"hidden"});this.background.show()}else this.baseElement.parent().hide(),this.background||(this.background=ff$("#"+this.baseElement.attr("id")+"MdlBckgrnd")),this.background.hide()},showModalPanel:function(n){this.showPanel=n;this.hfShowPanel&&this.hfShowPanel.val(n);ff$(document.body).css({"margin-right":0,overflow:"visible"});this.doLayout();n||this.Element.trigger("modalClosed");!n&&this.postbackOnClose&&__doPostBack()},setArgs:function(n){this.hfArgs&&this.hfArgs.val(n)}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffModalPanel,firefish.Web.WebControls.WebControl);firefish.Web.WebControls.ffModalPanel.show=function(n,t){var i=ffControlSystem.getControl(n);i&&(i.showModalPanel(!0),t&&i.setArgs(t))};firefish.Web.WebControls.ffModalPanel.hide=function(n){var t=ffControlSystem.getControl(n);t&&t.showModalPanel(!1)};
firefish.Web.WebControls.ffDocumentDownload=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffDocumentDownload,[n])};firefish.Web.WebControls.ffDocumentDownload.prototype={initialise:function(){ffControlSystem.callBase(this,firefish.Web.WebControls.ffDocumentDownload,"initialise");var n=ffControlSystem.getFunctionDelegate(this,this.onDeleteDocument);this.lnkBtnDeleteImg=this.getChildElement("lnkBtnDeleteImg");this.lnkBtnDocumentImg=this.getChildElement("lnkBtnDocumentImg");ffControlSystem.attachEvent(this.lnkBtnDeleteImg,"click",n)},onDeleteDocument:function(n){var t=confirm("Are you sure you want to remove this file?");if(!t){n.preventDefault();return}this.ClientSideOnly&&(this.Element.hide(),n.preventDefault())}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffDocumentDownload,firefish.Web.WebControls.WebControl);
firefish.Web.WebControls.ffAdvertBackButton=function(n){this.sessionStorageReferrerKey="ffAdvertBackButtonReferrer";this.sessionStorageAdvertKey="ffAdvertBackButtonAdvert";ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffAdvertBackButton,[n])};firefish.Web.WebControls.ffAdvertBackButton.prototype={initialise:function(){ffControlSystem.callBase(this,firefish.Web.WebControls.ffAdvertBackButton,"initialise");var n=ffControlSystem.getFunctionDelegate(this,this.buttonClicked);ffControlSystem.attachEvent(this.Element,"click",n);this.saveCurrentReferrerToSession()},saveCurrentReferrerToSession:function(){if(this.saveCurrentReferrerIfAbsent&&this.advertIDBeingSave&&document.referrer&&sessionStorage){var n=sessionStorage.getItem(this.sessionStorageReferrerKey),t=sessionStorage.getItem(this.sessionStorageAdvertKey);n&&t===String(this.advertIDBeingSave)||(sessionStorage.setItem(this.sessionStorageReferrerKey,document.referrer),sessionStorage.setItem(this.sessionStorageAdvertKey,String(this.advertIDBeingSave)))}},buttonClicked:function(){if(this.alwaysRedirectToBackupURL&&this.backupRedirectURL)window.location.href=this.backupRedirectURL;else{let n=sessionStorage.getItem(this.sessionStorageReferrerKey);n?(sessionStorage.removeItem(this.sessionStorageReferrerKey),sessionStorage.removeItem(this.sessionStorageAdvertKey),!this.onlyUseSavedURLIfContainsPage||n.toLowerCase().includes("?")||n.toLowerCase().includes("page=")||(n=this.backupRedirectURL)):n=this.backupRedirectURL;window.location.href=n?n:"/"}}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffAdvertBackButton,firefish.Web.WebControls.WebControl);
firefish.Web.WebControls.ffEMailTextBox=function(n){ffControlSystem.baseConstructor(this,firefish.Web.WebControls.ffEMailTextBox,[n])};firefish.Web.WebControls.ffEMailTextBox.prototype={initialise:function(){if(ffControlSystem.callBase(this,firefish.Web.WebControls.ffEMailTextBox,"initialise"),this.fiTick=ff$("[id$='fiTickWrapper']"),this.fiError=ff$("[id$='fiErrorWrapper']"),this.saveButtonID!=null&&(this.btnSave=ff$("[id='"+this.saveButtonID+"']"),this.btnSave.prop("disabled",!0)),this.txtEmailTextBox=this.Element,this.txtEmailTextBox){var n=ffControlSystem.getFunctionDelegate(this,this.onBlur);ffControlSystem.attachEvent(this.txtEmailTextBox,"blur",n)}},dispose:function(){},onBlur:function(){this.validateEmail()},_onSuccess:function(n){(n&&(n=ffParseJson(n)),n)&&(n.userExists?this.txtEmailTextBox.attr("isinvalid",!0):this.txtEmailTextBox.attr("isinvalid",!1),firefish.Utilities.Validation.Revalidate(this.Element),firefish.Utilities.Validation.IsControlValid(this.Element)?this.showTick():this.showError())},_onFail:function(){this.handleSaveButton(!1)},showError:function(){this.fiTick.removeClass("show");this.fiTick.addClass("hide");this.fiError.removeClass("hide");this.fiError.addClass("show");this.handleSaveButton(!1)},showTick:function(){this.fiTick.removeClass("hide");this.fiTick.addClass("show");this.fiError.removeClass("show");this.fiError.addClass("hide");this.handleSaveButton(!0)},validateEmail:function(){var i=ffControlSystem.getFunctionDelegate(this,this._onSuccess),r=ffControlSystem.getFunctionDelegate(this,this._onFail),n={UserName:this.Element.val()},t;this.verifyAccount&&(!this.initialEmailAddress||this.initialEmailAddress!=n.UserName)?ffControlSystem.callWebService("/_firefish/Handlers/accountverification.ashx",JSON.stringify(n),i,r):(this.fiTick.removeClass("show"),this.fiTick.addClass("hide"),this.fiError.removeClass("show"),this.fiError.addClass("hide"),firefish.Utilities.Validation.Revalidate(this.Element),t=firefish.Utilities.Validation.IsControlValid(this.Element),this.handleSaveButton(t))},handleSaveButton:function(n){this.btnSave!=null&&this.btnSave.prop("disabled",!n)}};ffControlSystem.deriveClass(firefish.Web.WebControls.ffEMailTextBox,firefish.Web.WebControls.ffTextBox);firefish.Web.WebControls.ffEMailTextBox.Validate=function(n,t){var u=ff$(n),i=ffControlSystem.getControl(u.prop("controltovalidate")),r;i&&i.Element&&(r=!0,i.Element.attr("isinvalid")=="true"&&(r=!1),t.IsValid=r)};
jQuery.noConflict(!0);
